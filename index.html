<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palace Cars - Location de Voitures</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f4f7f9; }
        .hero-bg { background-image: url('https://placehold.co/1920x800/25385C/ffffff?text=Palace+Cars+Agadir'); background-size: cover; background-position: center; }
        /* Style pour masquer/afficher le panneau de confirmation */
        #confirmationMessage { transition: all 0.3s ease-in-out; }
    </style>
</head>
<body>

<!-- Header -->
<header class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
        <div class="text-2xl font-bold text-blue-800">PALACECARS</div>
        <nav class="hidden md:flex space-x-8 text-gray-700 font-medium">
            <a href="#" class="hover:text-blue-600 transition duration-150">Accueil</a>
            <a href="#" class="hover:text-blue-600 transition duration-150">Flotte</a>
            <a href="#" class="hover:text-blue-600 transition duration-150">Services</a>
            <a href="#" class="hover:text-blue-600 transition duration-150">FAQ</a>
            <a href="#" class="hover:text-blue-600 transition duration-150">Contact</a>
        </nav>
        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-150 shadow-md">
            R√©server Maintenant
        </button>
    </div>
</header>

<!-- Hero Section and Booking Form -->
<div class="hero-bg py-20 md:py-32 flex items-center justify-center">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full">
        <div class="text-center text-white mb-12">
            <h1 class="text-4xl sm:text-5xl font-extrabold mb-4 leading-tight">
                D√©couvrez notre flotte diversifi√©e, offrant luxe, √©conomie et 4x4 pour chaque aventure.
            </h1>
            <p class="text-xl font-medium">Location de voitures √† Agadir, Maroc, au meilleur prix garanti.</p>
        </div>

        <!-- Booking Form Card (Fast Reservation) -->
        <div id="booking-form-card" class="bg-white p-6 sm:p-10 rounded-xl shadow-2xl max-w-4xl mx-auto transform -translate-y-8">
            <h2 class="text-2xl font-bold text-center text-gray-800 mb-6 border-b pb-3">R√©servation Rapide</h2>

            <!-- Confirmation Message Box (Hidden by Default) -->
            <div id="confirmationMessage" class="hidden p-4 rounded-lg text-center font-semibold mb-4 opacity-0 transition duration-300"></div>

            <form id="bookingForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">

                <!-- Nom et Pr√©nom -->
                <div>
                    <label for="fullName" class="block text-sm font-medium text-gray-700">Nom et Pr√©nom</label>
                    <input type="text" id="fullName" name="fullName" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- Num√©ro de T√©l√©phone -->
                <div>
                    <label for="phone" class="block text-sm font-medium text-gray-700">Num√©ro de T√©l√©phone</label>
                    <input type="tel" id="phone" name="phone" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500" placeholder="Ex: 06 XX XX XX XX">
                </div>

                <!-- Lieu de Prise en Charge -->
                <div>
                    <label for="pickupLocation" class="block text-sm font-medium text-gray-700">Lieu de Prise en Charge</label>
                    <input type="text" id="pickupLocation" name="pickupLocation" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- Lieu de Retour -->
                <div>
                    <label for="returnLocation" class="block text-sm font-medium text-gray-700">Lieu de Retour</label>
                    <input type="text" id="returnLocation" name="returnLocation" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- Date et Heure de Prise en Charge -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="pickupDate" class="block text-sm font-medium text-gray-700">Date de Prise en Charge</label>
                        <input type="date" id="pickupDate" name="pickupDate" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="pickupTime" class="block text-sm font-medium text-gray-700">Heure</label>
                        <input type="time" id="pickupTime" name="pickupTime" value="10:00" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>

                <!-- Date et Heure de Retour -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="returnDate" class="block text-sm font-medium text-gray-700">Date de Retour</label>
                        <input type="date" id="returnDate" name="returnDate" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="returnTime" class="block text-sm font-medium text-gray-700">Heure</label>
                        <input type="time" id="returnTime" name="returnTime" value="10:00" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="md:col-span-2 mt-4">
                    <button type="submit" id="submitButton" class="w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-xl text-lg font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150">
                        <span id="buttonText">Soumettre la Demande de R√©servation</span>
                        <svg id="loadingSpinner" class="hidden animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </button>
                    <!-- Error Message Display -->
                    <div id="dbErrorMessage" class="mt-3 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden"></div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Featured Cars Section -->
<section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl font-extrabold text-gray-900 mb-4">Notre Flotte Populaire</h2>
        <p class="text-xl text-gray-600 mb-12">Des v√©hicules neufs et bien entretenus pour tous les budgets.</p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Car Card 1 -->
            <div class="bg-gray-50 p-6 rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                <img src="https://placehold.co/400x250/25385C/ffffff?text=Voiture+Economique" alt="Voiture √âconomique" class="w-full h-40 object-cover rounded-lg mb-4">
                <h3 class="text-xl font-bold text-gray-800 mb-2">Dacia Logan</h3>
                <p class="text-gray-600 mb-4">Compacte et √©conomique, id√©ale pour les d√©placements en ville.</p>
                <div class="flex justify-between items-center text-lg font-semibold">
                    <span class="text-blue-600">350 MAD / jour</span>
                    <button class="text-blue-600 hover:text-blue-800 transition duration-150">Voir D√©tails</button>
                </div>
            </div>

            <!-- Car Card 2 -->
            <div class="bg-gray-50 p-6 rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                <img src="https://placehold.co/400x250/34495e/ffffff?text=Voiture+Familiale" alt="Voiture Familiale" class="w-full h-40 object-cover rounded-lg mb-4">
                <h3 class="text-xl font-bold text-gray-800 mb-2">Hyundai Tucson</h3>
                <p class="text-gray-600 mb-4">Confortable et spacieuse, parfaite pour les familles et les longs trajets.</p>
                <div class="flex justify-between items-center text-lg font-semibold">
                    <span class="text-blue-600">600 MAD / jour</span>
                    <button class="text-blue-600 hover:text-blue-800 transition duration-150">Voir D√©tails</button>
                </div>
            </div>

            <!-- Car Card 3 -->
            <div class="bg-gray-50 p-6 rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                <img src="https://placehold.co/400x250/474747/ffffff?text=Voiture+4x4+Luxe" alt="Voiture 4x4 Luxe" class="w-full h-40 object-cover rounded-lg mb-4">
                <h3 class="text-xl font-bold text-gray-800 mb-2">Range Rover Evoque</h3>
                <p class="text-gray-600 mb-4">Luxe et performance, pour une exp√©rience de conduite inoubliable.</p>
                <div class="flex justify-between items-center text-lg font-semibold">
                    <span class="text-blue-600">1500 MAD / jour</span>
                    <button class="text-blue-600 hover:text-blue-800 transition duration-150">Voir D√©tails</button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Services Section -->
<section class="py-16 bg-gray-100">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl font-extrabold text-gray-900 mb-4">Nos Engagements</h2>
        <p class="text-xl text-gray-600 mb-12">Pourquoi choisir Palace Cars pour votre location √† Agadir.</p>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <!-- Service 1 -->
            <div class="p-6 bg-white rounded-xl shadow-md">
                <svg class="w-10 h-10 mx-auto text-blue-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.657 0 3 .895 3 2s-1.343 2-3 2h-1v4m-2-4v4m2-4v4m1-9h1a2 2 0 012 2v2a2 2 0 01-2 2h-1m2-4a2 2 0 00-2 2v2a2 2 0 002 2h1"></path></svg>
                <h3 class="text-lg font-bold text-gray-800 mb-2">Prix Transparents</h3>
                <p class="text-gray-600 text-sm">Pas de frais cach√©s. Le prix affich√© est le prix que vous payez.</p>
            </div>

            <!-- Service 2 -->
            <div class="p-6 bg-white rounded-xl shadow-md">
                <svg class="w-10 h-10 mx-auto text-blue-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                <h3 class="text-lg font-bold text-gray-800 mb-2">Qualit√© Garantie</h3>
                <p class="text-gray-600 text-sm">Tous nos v√©hicules sont neufs, bien entretenus et assur√©s.</p>
            </div>

            <!-- Service 3 -->
            <div class="p-6 bg-white rounded-xl shadow-md">
                <svg class="w-10 h-10 mx-auto text-blue-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                <h3 class="text-lg font-bold text-gray-800 mb-2">Service 24/7</h3>
                <p class="text-gray-600 text-sm">Assistance routi√®re disponible jour et nuit pour votre tranquillit√©.</p>
            </div>

            <!-- Service 4 -->
            <div class="p-6 bg-white rounded-xl shadow-md">
                <svg class="w-10 h-10 mx-auto text-blue-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                <h3 class="text-lg font-bold text-gray-800 mb-2">Livraison Partout</h3>
                <p class="text-gray-600 text-sm">Livraison et r√©cup√©ration du v√©hicule √† l'a√©roport ou √† votre h√¥tel.</p>
            </div>
        </div>
    </div>
</section>


<!-- Footer -->
<footer class="bg-gray-800 text-white py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- Logo and About -->
        <div>
            <div class="text-2xl font-bold text-blue-400 mb-3">PALACECARS</div>
            <p class="text-gray-400 text-sm">Votre partenaire de confiance pour la location de voitures √† Agadir.</p>
        </div>

        <!-- Quick Links -->
        <div>
            <h3 class="text-lg font-semibold mb-4 border-b border-gray-700 pb-2">Liens Rapides</h3>
            <ul class="space-y-2 text-sm">
                <li><a href="#" class="text-gray-400 hover:text-white transition duration-150">Flotte Compl√®te</a></li>
                <li><a href="#" class="text-gray-400 hover:text-white transition duration-150">Conditions G√©n√©rales</a></li>
                <li><a href="#" class="text-gray-400 hover:text-white transition duration-150">FAQ</a></li>
            </ul>
        </div>

        <!-- Contact Info -->
        <div>
            <h3 class="text-lg font-semibold mb-4 border-b border-gray-700 pb-2">Contactez-nous</h3>
            <p class="text-sm text-gray-400 mb-2">
                <span class="font-medium text-white">T√©l√©phone :</span> +212 659198122
            </p>
            <p class="text-sm text-gray-400 mb-2">
                <span class="font-medium text-white">Email :</span> contact@palacecars.ma
            </p>
        </div>

        <!-- Admin Access Note (Removed for Vercel) -->
        <div>
            <h3 class="text-lg font-semibold mb-4 border-b border-gray-700 pb-2">Admin</h3>
            <p class="text-gray-400 text-sm">
                Ouvrez le fichier `admin_panel.html` pour la bo√Æte de r√©ception des r√©servations.
            </p>
        </div>
    </div>
    <div class="text-center mt-8 text-gray-500 text-sm border-t border-gray-700 pt-6">
        &copy; 2024 Palace Cars. Tous droits r√©serv√©s.
    </div>
</footer>


<!-- FIREBASE SCRIPTS -->
<script type="module">
    // üõë VOTRE CONFIGURATION FIREBASE EST MAINTENANT COLL√âE ICI 
    const firebaseConfig = {
        apiKey: "AIzaSyCsPHf_v8-gEiWGQzkwses-jOiDXs9tvWo",
        authDomain: "palace-cars.firebaseapp.com",
        projectId: "palace-cars",
        storageBucket: "palace-cars.firebasestorage.app",
        messagingSenderId: "469852272715",
        appId: "1:469852272715:web:6e87dc7083cdc04e03b5ce",
        // measurementId: "G-KCEF4WBW0G" // Optionnel, retir√© pour la simplicit√©
    };

    // Nom de la collection de la base de donn√©es, simplifi√© pour √©viter les probl√®mes de chemin
    const BOOKING_COLLECTION_NAME = 'palace_cars_bookings';
    
    // Si la configuration est manquante (ne devrait plus arriver)
    if (Object.keys(firebaseConfig).length === 0 || !firebaseConfig.apiKey) {
        document.addEventListener('DOMContentLoaded', () => {
            const errorElement = document.getElementById('dbErrorMessage');
            if (errorElement) {
                errorElement.classList.remove('hidden');
                errorElement.innerHTML = `<strong>Erreur de Configuration:</strong> La cl√© API Firebase est manquante.`;
            }
        });
    }

    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    setLogLevel('error'); 

    let app;
    let db;
    let auth;
    let userId;

    // --- Firebase Initialization and Authentication ---
    async function initializeFirebase() {
        if (Object.keys(firebaseConfig).length === 0 || !firebaseConfig.apiKey) return false; 

        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            
            // Authentification anonyme simplifi√©e pour Vercel
            await signInAnonymously(auth);
            
            userId = auth.currentUser?.uid || crypto.randomUUID();
            console.log('Firebase initialis√©. Utilisateur ID:', userId);

            const errorElement = document.getElementById('dbErrorMessage');
            if (errorElement) {
                errorElement.classList.add('hidden');
            }

            return true;
        } catch (error) {
            console.error("Erreur d'initialisation de Firebase ou d'authentification:", error);
            const errorElement = document.getElementById('dbErrorMessage');
            if (errorElement) {
                errorElement.classList.remove('hidden');
                errorElement.innerHTML = `<strong>Erreur de service:</strong> La connexion √† la base de donn√©es a √©chou√©. V√©rifiez votre configuration Firebase et vos r√®gles de s√©curit√©.`;
            }
            return false;
        }
    }

    // --- Booking Submission Handler ---
    document.getElementById('bookingForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const submitButton = document.getElementById('submitButton');
        const buttonText = document.getElementById('buttonText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const confirmationMessage = document.getElementById('confirmationMessage');
        const dbErrorMessage = document.getElementById('dbErrorMessage');

        // R√©initialisation de l'√©tat
        confirmationMessage.classList.add('hidden', 'opacity-0');
        dbErrorMessage.classList.add('hidden');
        buttonText.textContent = "Soumettre la Demande de R√©servation";
        submitButton.disabled = true;
        loadingSpinner.classList.remove('hidden');

        // 1. Initialiser Firebase
        const isReady = await initializeFirebase();
        if (!isReady) {
            submitButton.disabled = false;
            loadingSpinner.classList.add('hidden');
            return;
        }

        const formData = new FormData(this);
        const bookingData = {
            fullName: formData.get('fullName'),
            phone: formData.get('phone'),
            pickupLocation: formData.get('pickupLocation'),
            returnLocation: formData.get('returnLocation'),
            pickupDateTime: new Date(formData.get('pickupDate') + 'T' + formData.get('pickupTime')).toISOString(),
            returnDateTime: new Date(formData.get('returnDate') + 'T' + formData.get('returnTime')).toISOString(),
            status: 'Nouvelle Demande',
            timestamp: new Date().toISOString(),
            clientId: userId, 
        };

        try {
            // Utilisation du chemin simplifi√©
            const docRef = await addDoc(collection(db, BOOKING_COLLECTION_NAME), bookingData);
            
            console.log("R√©servation enregistr√©e avec succ√®s dans Firestore. ID du document:", docRef.id);

            // Succ√®s
            confirmationMessage.classList.remove('hidden');
            confirmationMessage.classList.remove('bg-red-100', 'text-red-700', 'border-red-400');
            confirmationMessage.classList.add('bg-green-100', 'text-green-700', 'border-green-400', 'border');
            confirmationMessage.innerHTML = 'Demande Envoy√©e avec Succ√®s ! Nous vous contacterons rapidement au ' + bookingData.phone + ' pour confirmer votre r√©servation.';
            setTimeout(() => confirmationMessage.classList.remove('opacity-0'), 10); 

            this.reset();
            
        } catch (e) {
            console.error("Erreur d'√©criture de la base de donn√©es:", e);
            
            // √âchec
            dbErrorMessage.classList.remove('hidden');
            dbErrorMessage.innerHTML = `<strong>Erreur de service:</strong> La soumission a √©chou√©. Veuillez v√©rifier si vous avez bien configur√© les r√®gles de s√©curit√© Firestore.`;
            
        } finally {
            submitButton.disabled = false;
            loadingSpinner.classList.add('hidden');
            buttonText.textContent = "Soumettre la Demande de R√©servation";
        }
    });

</script>
</body>
</html>
